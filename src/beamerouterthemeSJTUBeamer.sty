%% beamerouterthemeSJTUBeamer.sty
%% Copyright 2021 Log Creative
%% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
% https://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status ‘maintained’.
%
% The Current Maintainer of this work is Log Creative.
%

% The head- and footline.

% The sidebars.

% \defbeamertemplate*{sidebar right}{SJTUBeamer}
% {
%   \vfill%
%   \llap{\insertlogo\hskip0.1cm}%
%   \vskip2pt%
%   %\llap{\usebeamertemplate***{navigation symbols}\hskip0.1cm}%
%   \vskip2pt%
% }

\addtobeamertemplate{navigation symbols}{}{%
    \usebeamerfont{footline}%
    \usebeamercolor[fg]{footline}%
    \hspace{1em}%
    \raisebox{1.2pt}[0pt][0pt]{\insertframenumber/\inserttotalframenumber}
}

% The logo.

% The frame title.

\pgfdeclareimage[height=0.7cm]{titlelogosmall}{vi/cnlogo.pdf}
\defbeamertemplate*{frametitle}{SJTUBeamer}[1][left]
{%
  \ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
  \@tempdima=\textwidth%
  \advance\@tempdima by\beamer@leftmargin%
  \advance\@tempdima by\beamer@rightmargin%
  \begin{beamercolorbox}[sep=0.3cm,#1,wd=\the\@tempdima]{frametitle}
    \begingroup
    \usebeamerfont{frametitle}%
    \vbox{}
    \ifx\insertframesubtitle\@empty\vskip-2px%
    \else\vskip-1ex\fi%
    \if@tempswa\else\csname beamer@fte#1\endcsname\fi%
    \strut\insertframetitle\strut\par%
    {%
      \ifx\insertframesubtitle\@empty%
      \else%
      {\usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\strut\insertframesubtitle\strut\par}%
      \fi
    }%
    \vskip-1ex%
    \endgroup%
    \raggedleft%
    \begingroup
    \ifx\insertframesubtitle\@empty\vskip-2.5ex%
    \else\vskip-3.5ex\fi%
    \pgfuseimage{titlelogosmall}\hspace*{2ex}%
    \endgroup%
    \ifx\insertframesubtitle\@empty%
    \else\vskip0.5ex\fi%
    \if@tempswa\else\vskip-.3cm\fi% set inside beamercolorbox... evil here...
  \end{beamercolorbox}%
}